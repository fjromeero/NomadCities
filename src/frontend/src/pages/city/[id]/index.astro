---
import MainLayout from "../../../layouts/MainLayout.astro";
import {getCityDetails} from "../../../utils/server/city";
import CityInspect from "../../../components/city/CityInspect";
import { isCurrentUserAdmin } from "../../../utils/server/users";


const {id} = Astro.params;
const userToken = Astro.cookies.get("user").value;
const isAdmin = await isCurrentUserAdmin(userToken)
let cityData = {}

const response = await getCityDetails(userToken, id);
if(response.status!=200){
    return Astro.redirect('/');
}else{
    cityData = response.data;
}

console.log(response)
---

<MainLayout title='NomadCities - City'>
    <CityInspect client:only cityData={cityData} isAdmin={isAdmin} id={id}/>
</MainLayout>